<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Gitlab CICD学习记录 | Yiiong's Blog</title><meta name="author" content="Yiiong"><meta name="copyright" content="Yiiong"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Gitlab CICD学习记录用Flask在K8s集群编写后端项目编写app.py编写一个最简单的后端项目，命名为app.py，返回hello world! from flask import Flaskapp &#x3D; Flask(__name__)@app.route(&#x27;&#x2F;&#x27;)def hello():    return &quot;hello world!&quot;if __">
<meta property="og:type" content="article">
<meta property="og:title" content="Gitlab CICD学习记录">
<meta property="og:url" content="http://example.com/2025/12/08/Gitlab%20CICD%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/index.html">
<meta property="og:site_name" content="Yiiong&#39;s Blog">
<meta property="og:description" content="Gitlab CICD学习记录用Flask在K8s集群编写后端项目编写app.py编写一个最简单的后端项目，命名为app.py，返回hello world! from flask import Flaskapp &#x3D; Flask(__name__)@app.route(&#x27;&#x2F;&#x27;)def hello():    return &quot;hello world!&quot;if __">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/ava.jpg">
<meta property="article:published_time" content="2025-12-08T14:00:22.454Z">
<meta property="article:modified_time" content="2025-12-08T14:17:02.092Z">
<meta property="article:author" content="Yiiong">
<meta property="article:tag" content="CICD">
<meta property="article:tag" content="服务器运维">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/ava.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Gitlab CICD学习记录",
  "url": "http://example.com/2025/12/08/Gitlab%20CICD%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/",
  "image": "http://example.com/img/ava.jpg",
  "datePublished": "2025-12-08T14:00:22.454Z",
  "dateModified": "2025-12-08T14:17:02.092Z",
  "author": [
    {
      "@type": "Person",
      "name": "Yiiong",
      "url": "http://example.com"
    }
  ]
}</script><link rel="shortcut icon" href="/img/logo.svg"><link rel="canonical" href="http://example.com/2025/12/08/Gitlab%20CICD%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css?v=5.5.2"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.json","preload":false,"top_n_per_article":1,"unescape":false,"pagination":{"enable":false,"hitsPerPage":8},"languages":{"hits_empty":"未找到符合您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":"true`"},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":150,"languages":{"author":"作者: Yiiong","link":"链接: ","source":"来源: Yiiong's Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'FancyBox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Gitlab CICD学习记录',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><link rel="stylesheet" href="/css/universe.css"><meta name="generator" content="Hexo 8.1.1"></head><body><div id="web_bg" style="background: transparent;"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/ava.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/img/tag.jpg);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Yiiong's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">Gitlab CICD学习记录</span><span class="site-name"><i class="fa-solid fa-circle-arrow-left"></i><span>  返回首页</span></span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 文章</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Gitlab CICD学习记录</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-12-08T14:00:22.454Z" title="发表于 2025-12-08 22:00:22">2025-12-08</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-12-08T14:17:02.092Z" title="更新于 2025-12-08 22:17:02">2025-12-08</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%90%E7%BB%B4/">服务器运维</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><h1 id="Gitlab-CICD学习记录"><a href="#Gitlab-CICD学习记录" class="headerlink" title="Gitlab CICD学习记录"></a>Gitlab CICD学习记录</h1><h1 id="用Flask在K8s集群编写后端项目"><a href="#用Flask在K8s集群编写后端项目" class="headerlink" title="用Flask在K8s集群编写后端项目"></a>用Flask在K8s集群编写后端项目</h1><h2 id="编写app-py"><a href="#编写app-py" class="headerlink" title="编写app.py"></a>编写app.py</h2><p>编写一个最简单的后端项目，命名为app.py，返回hello world!</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">from flask import Flask</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">@app.route(&#x27;/&#x27;)</span><br><span class="line">def hello():</span><br><span class="line">    return &quot;hello world!&quot;</span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">    app.run(host=&#x27;0.0.0.0&#x27;, port=8080)</span><br></pre></td></tr></table></figure>

<h2 id="用pipreqs导出依赖文件"><a href="#用pipreqs导出依赖文件" class="headerlink" title="用pipreqs导出依赖文件"></a>用pipreqs导出依赖文件</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip3 install pipreqs</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pipreqs . --encoding=utf8 --force</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/beatrueman/images/raw/master/20251208210638359.png" alt="image-20230607202155815"></p>
<h2 id="构建Docker镜像"><a href="#构建Docker镜像" class="headerlink" title="构建Docker镜像"></a>构建Docker镜像</h2><p>编写dockerfile</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FROM python:3.9</span><br><span class="line"></span><br><span class="line">WORKDIR /app</span><br><span class="line"></span><br><span class="line">COPY requirements.txt .</span><br><span class="line">RUN pip install --no-cache-dir -r requirements.txt</span><br><span class="line"></span><br><span class="line">COPY . .</span><br><span class="line"></span><br><span class="line">CMD [&quot;python&quot;,&quot;app.py&quot;]</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker build -t beatrueman/ci:2.0 .</span><br></pre></td></tr></table></figure>

<p>上传镜像</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker push beatrueman/ci:2.0</span><br></pre></td></tr></table></figure>

<h2 id="K8s集群部署后端服务"><a href="#K8s集群部署后端服务" class="headerlink" title="K8s集群部署后端服务"></a>K8s集群部署后端服务</h2><p>使用命令创建Pod。创建一个名为<code>flask-hello-world</code>的Pod，并将容器的端口映射到主机的端口8080。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kubectl run flask-hello-world --image=beatrueman/ci:2.0 --port=8080 </span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/beatrueman/images/raw/master/20251208210645849.png" alt="image-20230609140113784"></p>
<p>使用命令暴露服务。以LoadBalancer类型创建服务，映射到Pod的8080端口</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kubectl expose pod flask-hello-world --type=LoadBalancer --port=80 --target-port=8080</span><br></pre></td></tr></table></figure>

<p>查看服务</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kubectl get service flask-hello-world</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/beatrueman/images/raw/master/20251208210645850.png" alt="image-20230609140541562"></p>
<p>开放32091端口，访问外部ip</p>
<p><img src="https://gitee.com/beatrueman/images/raw/master/20251208210645851.png" alt="image-20230609140631331"></p>
<p><img src="https://gitee.com/beatrueman/images/raw/master/20251208210645852.png" alt="image-20230609140646482"></p>
<p>成功</p>
<h1 id="安装runner"><a href="#安装runner" class="headerlink" title="安装runner"></a>安装runner</h1><h2 id="获取registration-token"><a href="#获取registration-token" class="headerlink" title="获取registration-token"></a>获取registration-token</h2><p><img src="https://gitee.com/beatrueman/images/raw/master/20251208210645853.png" alt="image-20230611174544623"></p>
<h2 id="使用docker安装runner"><a href="#使用docker安装runner" class="headerlink" title="使用docker安装runner"></a>使用docker安装runner</h2><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker run -d --name gitlab-runner --restart always \</span><br><span class="line">  -v /srv/gitlab-runner/config:/etc/gitlab-runner \</span><br><span class="line">  -v /var/run/docker.sock:/var/run/docker.sock \</span><br><span class="line">  gitlab/gitlab-runner:latest</span><br></pre></td></tr></table></figure>

<h3 id="注册"><a href="#注册" class="headerlink" title="注册"></a>注册</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker exec -it gitlab-runner bash</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gitlab-runner register \</span><br><span class="line">--non-interactive \</span><br><span class="line">--url &quot;https://gitlab.com/&quot; \</span><br><span class="line">--registration-token &quot;GR1348941F_CsNBNspPP2DccgUVcx&quot; \ </span><br><span class="line">--executor &quot;docker&quot; \</span><br><span class="line">--docker-image ubuntu:22.04 \</span><br><span class="line">--description &quot;docker-runner&quot; \</span><br><span class="line">--maintenance-note &quot;Free-form maintainer notes about this runner&quot; \</span><br><span class="line">--tag-list &quot;docker&quot; \</span><br><span class="line">--run-untagged=&quot;true&quot; \</span><br><span class="line">--locked=&quot;false&quot; \</span><br><span class="line">--access-level=&quot;not_protected&quot;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>成功</p>
<p><img src="https://gitee.com/beatrueman/images/raw/master/20251208210645854.png" alt="image-20230610222258752"></p>
<p>#一直把registration-token当成runner里的token了，导致后面不停报错#</p>
<h2 id="使用helm安装runner（失败）"><a href="#使用helm安装runner（失败）" class="headerlink" title="使用helm安装runner（失败）"></a>使用helm安装runner（失败）</h2><h3 id="下载package并解压"><a href="#下载package并解压" class="headerlink" title="下载package并解压"></a>下载package并解压</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">helm repo add gitlab https://charts.gitlab.io</span><br><span class="line">helm pull gitlab/gitlab-runner</span><br><span class="line">tar -zxvf gitlab-runner-0.53.2.tgz</span><br></pre></td></tr></table></figure>

<p>文件目录如下</p>
<p><img src="https://gitee.com/beatrueman/images/raw/master/20251208210645855.png" alt="image-20230609224911559"></p>
<h3 id="配置token填入和docker鉴权"><a href="#配置token填入和docker鉴权" class="headerlink" title="配置token填入和docker鉴权"></a>配置token填入和docker鉴权</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">apiVersion: v1</span><br><span class="line">kind: Secret</span><br><span class="line">metadata:</span><br><span class="line">  name: gitlab-runner-secret</span><br><span class="line">type: Opaque</span><br><span class="line">data:</span><br><span class="line"># 配置runner的token</span><br><span class="line">  runner-registration-token: &quot;R1IxMzQ4OTQxRl9Dc05CTnNwUFAyRGNjZ1VWY3gK&quot; # 将token转为base64后写这里</span><br><span class="line">  runner-token: &quot;&quot;</span><br><span class="line">---</span><br><span class="line">apiVersion: v1</span><br><span class="line">data:</span><br><span class="line"># 配置docker的config.json</span><br><span class="line">  .dockerconfigjson: &quot;ewogICAgICAgICJhdXRocyI6IHsKICAgICAgICAgICAgICAgICJodHRwczovL2luZGV4LmRvY2tlci5pby92MS8iOiB7CiAgICAgICAgICAgICAgICAgICAgICAgICJhdXRoIjogIlltVmhkSEoxWlcxaGJqcHNlWGd3TXpBNU1UWT0iCiAgICAgICAgICAgICAgICB9CiAgICAgICAgfQp9Cgo=&quot;</span><br><span class="line">kind: Secret</span><br><span class="line">metadata:</span><br><span class="line">  name: regsecret</span><br><span class="line">type: kubernetes.io/dockerconfigjson</span><br></pre></td></tr></table></figure>

<h3 id="在values-yaml中应用配置文件"><a href="#在values-yaml中应用配置文件" class="headerlink" title="在values.yaml中应用配置文件"></a>在values.yaml中应用配置文件</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">gitlabUrl: https://gitlab.com/Beatrueman/test.git</span><br><span class="line"></span><br><span class="line">runners:</span><br><span class="line"># 在这里指定我们刚刚创建的secret</span><br><span class="line">  secret: gitlab-runner-secret</span><br><span class="line">  imagePullSecrets: regsecret</span><br><span class="line">  tags: &quot;k8s&quot;</span><br><span class="line">  config: |</span><br><span class="line">    [[runners]]</span><br><span class="line">      [runners.kubernetes]</span><br><span class="line">        namespace = &quot;&#123;&#123;.Release.Namespace&#125;&#125;&quot;</span><br><span class="line">        image = &quot;ubuntu:20.04&quot;</span><br></pre></td></tr></table></figure>

<h1 id="镜像上传"><a href="#镜像上传" class="headerlink" title="镜像上传"></a>镜像上传</h1><h3 id="自定义kaniko镜像"><a href="#自定义kaniko镜像" class="headerlink" title="自定义kaniko镜像"></a>自定义kaniko镜像</h3><p>提前在<strong>CI&#x2F;CD &gt; Variables</strong>下设置好变量</p>
<p><img src="https://gitee.com/beatrueman/images/raw/master/20251208210645856.png" alt="image-20230611224208441"></p>
<p>在<code>/root/kaniko</code>下编写dockerfile和build-upload</p>
<p><img src="https://gitee.com/beatrueman/images/raw/master/20251208210645857.png" alt="image-20230610152445422"></p>
<p>dockerfile</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">FROM lonewalkerchr/kaniko:debug</span><br><span class="line"></span><br><span class="line">COPY ./build-upload /kaniko/build-upload</span><br><span class="line"></span><br><span class="line">SHELL [&quot;/busybox/sh&quot;]</span><br><span class="line"></span><br><span class="line">RUN [&quot;/busybox/chmod&quot;, &quot;a+x&quot;, &quot;/kaniko/build-upload&quot;]</span><br></pre></td></tr></table></figure>

<p>build-upload</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">printf &quot;%s&quot; &quot;$&#123;DOCKER_AUTH&#125;&quot; &gt; /kaniko/.docker/config.json</span><br><span class="line"></span><br><span class="line">/kaniko/executor \</span><br><span class="line">     --force \</span><br><span class="line">     --cache \</span><br><span class="line">     --context &quot;$&#123;CI_PROJECT_DIR&#125;&quot; \</span><br><span class="line">     --dockerfile dockerfile \</span><br><span class="line">     --destination $&#123;destination&#125;</span><br></pre></td></tr></table></figure>

<p>构建镜像并上传至dockerhub</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker build -t beatrueman/kaniko:1.0 .</span><br><span class="line"></span><br><span class="line">docker push beatrueman/kaniko:1.0</span><br></pre></td></tr></table></figure>

<h1 id="上传代码"><a href="#上传代码" class="headerlink" title="上传代码"></a>上传代码</h1><h2 id="创建并配置-gitlab-ci-yaml"><a href="#创建并配置-gitlab-ci-yaml" class="headerlink" title="创建并配置.gitlab-ci.yaml"></a>创建并配置.gitlab-ci.yaml</h2><p>添加KUBE_CONFIG变量，内容为<code>~/.kube/config</code>的内容</p>
<p><img src="https://gitee.com/beatrueman/images/raw/master/20251208210645858.png" alt="image-20230610153746130"></p>
<p>创建并配置.gitlab-ci.yaml</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">stages:</span><br><span class="line">  - build</span><br><span class="line">  - deploy</span><br><span class="line"></span><br><span class="line">imagebuilder:</span><br><span class="line">  image: beatrueman/ci:kaniko</span><br><span class="line">  stage: build</span><br><span class="line">  variables:</span><br><span class="line">    destination: beatrueman/ci:2.0</span><br><span class="line">  script:</span><br><span class="line">    - /kaniko/build-upload</span><br><span class="line"></span><br><span class="line">deploy:</span><br><span class="line">  image: bitnami/kubectl</span><br><span class="line">  stage: deploy</span><br><span class="line">  script:</span><br><span class="line">    - echo $&#123;KUBE_CONFIG&#125; &gt; kubeconfig</span><br><span class="line">    - kubectl run flask-hello-world --image=beatrueman/ci:2.0 --port=8080 </span><br><span class="line">    - kubectl expose pod flask-hello-world --type=LoadBalancer --port=80 --target-port=8080</span><br></pre></td></tr></table></figure>

<h2 id="上传到仓库"><a href="#上传到仓库" class="headerlink" title="上传到仓库"></a>上传到仓库</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git init</span><br><span class="line"></span><br><span class="line">git add .</span><br><span class="line"></span><br><span class="line">git commit -m &quot;first&quot;</span><br><span class="line"></span><br><span class="line">git remote add origin https://gitlab.com/Beatrueman/test-ci.git</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">git push -u origin master</span><br></pre></td></tr></table></figure>

<p><img src="https://gitee.com/beatrueman/images/raw/master/20251208210645859.png" alt="image-20230610155728095"></p>
<h1 id="问题与解决"><a href="#问题与解决" class="headerlink" title="问题与解决"></a>问题与解决</h1><p>1.构建Docker镜像时CMD的时候少了一个后引号，折腾了半天。#感谢一下杨鑫同学了，多亏了他的慧眼。</p>
<p>2.安装runner时用的是registration-token，不是创建runner时候的token。</p>
<p>3.${CI_PROJECT_DIR}变量是自带的，是runner里面的一个不固定的位置，可以通过它来找到绝对路径，不能自行指定，不然会找不到文件导致报错。</p>
<p><img src="https://gitee.com/beatrueman/images/raw/master/20251208210645860.png" alt="image-20230612110258681"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">pip install -i https://pypi.tuna.tsinghua.edu.cn/simple</span><br></pre></td></tr></table></figure>

<p>pip安装的时候使用-i指定镜像源，下载速度会提升很多很多。</p>
<p>5..gitlab-ci.yaml里deploy加entrypoint覆盖。</p>
<p><img src="https://gitee.com/beatrueman/images/raw/master/20251208210645861.png" alt="image-20230611223818531"></p>
<p>6..gitlab-ci.yaml里deploy阶段执行kubectl命令建议每条命令都加–kuboeconfig&#x3D;.&#x2F;kubeconfig，保证每条命令都有权限。</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>文章作者: </span><span class="post-copyright-info"><a href="http://example.com">Yiiong</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>文章链接: </span><span class="post-copyright-info"><a href="http://example.com/2025/12/08/Gitlab%20CICD%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/">http://example.com/2025/12/08/Gitlab%20CICD%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来源 <a href="http://example.com" target="_blank">Yiiong's Blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%90%E7%BB%B4/">服务器运维</a><a class="post-meta__tags" href="/tags/CICD/">CICD</a></div><div class="post-share"><div class="social-share" data-image="/img/ava.jpg" data-sites="facebook,x,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/12/08/iManager-%E6%82%A8%E7%9A%84%E7%A7%81%E4%BA%BA%E9%95%9C%E5%83%8F%E7%AE%A1%E5%AE%B6/" title="iManager-您的私人镜像管家"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">iManager-您的私人镜像管家</div></div><div class="info-2"><div class="info-item-1">iManager-您的私人镜像管家尽管Docker官方提供了公共的镜像仓库DockerHub，但从安全性和稳定性等方面考虑，部署私有镜像仓库是非常有必要的。Harbor是一个由VMware公司开源的企业级的Docker Registry管理项目，是我们搭建私有镜像仓库的不二之选。 而自动化一直是运维工作中的重中之重。 Yiiong希望你能够将Harbor与飞书机器人联系起来，方便管理员统一管理镜像，使管理员随时都可以知晓仓库镜像的变动信息，管理员动动手指就可以对仓库里的镜像进行操作等。 前置准备 建议使用服务器搭建Harbor仓库，并且配置好https 申请一个飞书企业账号 可能需要一个域名？  任务友善的用户交互用户肯定需要知道你的机器人都可以干些什么事情吧 用户向机器人发送帮助，机器人返回可以实现的功能列表 当用户发送了一些乱七八糟的信息时，机器人需要做出一定的回复，比如我听不懂捏 Level 0 通知当镜像状态发生改变时，机器人向管理员发起通知 通知内容包括：  镜像状态（Push or Pull or Delete） 镜像名称以及标签 镜像状态改变的日期 镜像状态改变者 ...</div></div></div></a><a class="pagination-related" href="/2025/12/08/EasyCreater/" title="EasyCreater——一站式简历生成器"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">EasyCreater——一站式简历生成器</div></div><div class="info-2"><div class="info-item-1">EasyCreater是一个简历生成器。</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/12/08/redis/" title="Redis主从同步实验"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-08</div><div class="info-item-2">Redis主从同步实验</div></div><div class="info-2"><div class="info-item-1">需求 A：master，不加密（普通端口 6379） B：slave，从 A 同步，不加密（端口 16379），同时监听 TLS 加密端口 16380 C：slave，从 B 同步，通过 TLS（端口 16380）  部署生成自签名TLS证书 使用openssl生成自签名证书mkdir -p certs &amp;&amp; cd certs# 创建 CAopenssl genrsa -out ca.key 4096openssl req -x509 -new -nodes -key ca.key -sha256 -days 3650 -out ca.crt -subj &quot;/CN=Redis-CA&quot;# 创建 server key 和证书签名请求（CSR）openssl genrsa -out redis.key 2048openssl req -new -key redis.key -out redis.csr -subj &quot;/CN=redis-server&quot;# 使用 CA 签发 server 证书openssl x509 -req -in...</div></div></div></a><a class="pagination-related" href="/2025/12/08/%E8%BF%90%E7%BB%B4%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/" title="运维常用工具"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-08</div><div class="info-item-2">运维常用工具</div></div><div class="info-2"><div class="info-item-1">Harbor Harbor (goharbor.io)  尽管Docker官方提供了公共的镜像仓库DockerHub，但从安全性和稳定性等方面考虑，部署私有镜像仓库是非常有必要的。Harbor是一个由VMware公司开源的企业级的Docker Registry管理项目，是我们搭建私有镜像仓库的不二之选。 整体架构 如上图所示是 Harbor 2.0 的架构图，从上到下可分为代理层、功能层和数据层。  代理层：代理层实质上是一个 Nginx 反向代理，负责接收不同类型的客户端请求，包括浏览器、用户脚本、Docker 等，并根据请求类型和 URI 转发给不同的后端服务进行处理。 功能层： Portal：是一个基于 Argular 的前端应用，提供 Harbor 用户访问的界面。 Core：是 Harbor 中的核心组件，封装了 Harbor 绝大部分的业务逻辑。 JobService：异步任务组件，负责 Harbor 中很多比较耗时的功能，比如 Artifact 复制、扫描、垃圾回收等。 Docker Distribution：Harbor 通过 Distribution 实现 Ar...</div></div></div></a><a class="pagination-related" href="/2025/12/08/iManager-%E6%82%A8%E7%9A%84%E7%A7%81%E4%BA%BA%E9%95%9C%E5%83%8F%E7%AE%A1%E5%AE%B6/" title="iManager-您的私人镜像管家"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-08</div><div class="info-item-2">iManager-您的私人镜像管家</div></div><div class="info-2"><div class="info-item-1">iManager-您的私人镜像管家尽管Docker官方提供了公共的镜像仓库DockerHub，但从安全性和稳定性等方面考虑，部署私有镜像仓库是非常有必要的。Harbor是一个由VMware公司开源的企业级的Docker Registry管理项目，是我们搭建私有镜像仓库的不二之选。 而自动化一直是运维工作中的重中之重。 Yiiong希望你能够将Harbor与飞书机器人联系起来，方便管理员统一管理镜像，使管理员随时都可以知晓仓库镜像的变动信息，管理员动动手指就可以对仓库里的镜像进行操作等。 前置准备 建议使用服务器搭建Harbor仓库，并且配置好https 申请一个飞书企业账号 可能需要一个域名？  任务友善的用户交互用户肯定需要知道你的机器人都可以干些什么事情吧 用户向机器人发送帮助，机器人返回可以实现的功能列表 当用户发送了一些乱七八糟的信息时，机器人需要做出一定的回复，比如我听不懂捏 Level 0 通知当镜像状态发生改变时，机器人向管理员发起通知 通知内容包括：  镜像状态（Push or Pull or Delete） 镜像名称以及标签 镜像状态改变的日期 镜像状态改变者 ...</div></div></div></a><a class="pagination-related" href="/2025/12/08/BIND9%20DNS%E6%99%BA%E8%83%BD%E8%A7%A3%E6%9E%90%E5%AE%9E%E9%AA%8C/" title="BIND9 DNS智能解析实验"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-08</div><div class="info-item-2">BIND9 DNS智能解析实验</div></div><div class="info-2"><div class="info-item-1">BIND（Berkeley Internet Name Domain）  是全球使用最广泛的 DNS 服务器软件，最初由加州大学伯克利分校开发，目前由 ISC（Internet Systems Consortium）  维护。 BIND9 让一台服务器可以充当 DNS 解析器（递归）或权威服务器（发布域名解析记录） 目标基于bind9的view功能，实现DNS的智能解析。  master和两个slave之间实现主从同步 slave-1和slave-2均提供对www.a.com的解析，其中slave-1解析www至1.1.1.1；slave-2解析www至2.2.2.2  环境容器  bind-master：172.28.0.2 bind-slave-1：172.28.0.3 bind-slave-2：172.28.0.4  zone：a.com 域名：www.a.com  bind-slave-1视图：1.1.1.1 bind-slave-2视图：2.2.2.2  权威NS：ns1.a.com（172.28.0.2） NS：ns2.a.com（172.28.0.3、172.28....</div></div></div></a><a class="pagination-related" href="/2025/12/08/wasm-plugin-github%20action/" title="wasm-plugin-github action"><div class="cover" style="background: var(--default-bg-color)"></div><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-12-08</div><div class="info-item-2">wasm-plugin-github action</div></div><div class="info-2"><div class="info-item-1">功能描述功能：添加了利用 GitHub Actions 来自动完成相应的镜像构建和发布工作的Workflow。支持通过push tag和手动触发两种方式。同时也遵循使用oras打包工具。特点：完全按照Wasm 插件镜像规范进行镜像打包。 更新：  添加了查找文件的逻辑，会在插件目录中查找spec.yaml​、README.md​和README-{lang}.md​三个文件，有则在打包推送镜像时设置相应的media type​。 修改了review后存在的问题。 修改了builder​容器的启动命令为 docker run -itd --name builder xxx /bin/bash​，之前使用sleep 99999​是希望容器保持后台持续运行，这样只适合测试容器，不适合在生产环境中使用。 重新提交PR​是因为错误地提交了一些没用的commit​，不太会删除，担心破坏仓库并且为了保持PR​整洁所以重新提交。  1.准备工作添加Repository Secrets和 Repository variables。​​2.通过push tag​触发，先查找相关文件，然后将特定的插件打...</div></div></div></a></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/ava.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Yiiong</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">26</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">7</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://github.com/Beatrueman" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="mailto:yiiong@redrock.team" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">Study in Redrock SRE!</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#Gitlab-CICD%E5%AD%A6%E4%B9%A0%E8%AE%B0%E5%BD%95"><span class="toc-number">1.</span> <span class="toc-text">Gitlab CICD学习记录</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%94%A8Flask%E5%9C%A8K8s%E9%9B%86%E7%BE%A4%E7%BC%96%E5%86%99%E5%90%8E%E7%AB%AF%E9%A1%B9%E7%9B%AE"><span class="toc-number">2.</span> <span class="toc-text">用Flask在K8s集群编写后端项目</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E5%86%99app-py"><span class="toc-number">2.1.</span> <span class="toc-text">编写app.py</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%A8pipreqs%E5%AF%BC%E5%87%BA%E4%BE%9D%E8%B5%96%E6%96%87%E4%BB%B6"><span class="toc-number">2.2.</span> <span class="toc-text">用pipreqs导出依赖文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%84%E5%BB%BADocker%E9%95%9C%E5%83%8F"><span class="toc-number">2.3.</span> <span class="toc-text">构建Docker镜像</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#K8s%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E5%90%8E%E7%AB%AF%E6%9C%8D%E5%8A%A1"><span class="toc-number">2.4.</span> <span class="toc-text">K8s集群部署后端服务</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85runner"><span class="toc-number">3.</span> <span class="toc-text">安装runner</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96registration-token"><span class="toc-number">3.1.</span> <span class="toc-text">获取registration-token</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8docker%E5%AE%89%E8%A3%85runner"><span class="toc-number">3.2.</span> <span class="toc-text">使用docker安装runner</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%89%E8%A3%85"><span class="toc-number">3.2.1.</span> <span class="toc-text">安装</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B3%A8%E5%86%8C"><span class="toc-number">3.2.2.</span> <span class="toc-text">注册</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8helm%E5%AE%89%E8%A3%85runner%EF%BC%88%E5%A4%B1%E8%B4%A5%EF%BC%89"><span class="toc-number">3.3.</span> <span class="toc-text">使用helm安装runner（失败）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BDpackage%E5%B9%B6%E8%A7%A3%E5%8E%8B"><span class="toc-number">3.3.1.</span> <span class="toc-text">下载package并解压</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%85%8D%E7%BD%AEtoken%E5%A1%AB%E5%85%A5%E5%92%8Cdocker%E9%89%B4%E6%9D%83"><span class="toc-number">3.3.2.</span> <span class="toc-text">配置token填入和docker鉴权</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9C%A8values-yaml%E4%B8%AD%E5%BA%94%E7%94%A8%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="toc-number">3.3.3.</span> <span class="toc-text">在values.yaml中应用配置文件</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%95%9C%E5%83%8F%E4%B8%8A%E4%BC%A0"><span class="toc-number">4.</span> <span class="toc-text">镜像上传</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89kaniko%E9%95%9C%E5%83%8F"><span class="toc-number">4.1.</span> <span class="toc-text">自定义kaniko镜像</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%8A%E4%BC%A0%E4%BB%A3%E7%A0%81"><span class="toc-number">5.</span> <span class="toc-text">上传代码</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%B9%B6%E9%85%8D%E7%BD%AE-gitlab-ci-yaml"><span class="toc-number">5.1.</span> <span class="toc-text">创建并配置.gitlab-ci.yaml</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8A%E4%BC%A0%E5%88%B0%E4%BB%93%E5%BA%93"><span class="toc-number">5.2.</span> <span class="toc-text">上传到仓库</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%97%AE%E9%A2%98%E4%B8%8E%E8%A7%A3%E5%86%B3"><span class="toc-number">6.</span> <span class="toc-text">问题与解决</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/08/redis/" title="Redis主从同步实验">Redis主从同步实验</a><time datetime="2025-12-08T14:55:52.970Z" title="发表于 2025-12-08 22:55:52">2025-12-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/08/%E8%BF%90%E7%BB%B4%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7/" title="运维常用工具">运维常用工具</a><time datetime="2025-12-08T14:00:22.525Z" title="发表于 2025-12-08 22:00:22">2025-12-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/08/%E7%AE%97%E6%B3%95%E8%AE%B0%E5%BD%95/" title="算法记录">算法记录</a><time datetime="2025-12-08T14:00:22.521Z" title="发表于 2025-12-08 22:00:22">2025-12-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/08/%E5%AE%9E%E4%B9%A0%E6%80%BB%E7%BB%93/" title="Baidu实习总结">Baidu实习总结</a><time datetime="2025-12-08T14:00:22.515Z" title="发表于 2025-12-08 22:00:22">2025-12-08</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/12/08/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" title="数据结构">数据结构</a><time datetime="2025-12-08T14:00:22.515Z" title="发表于 2025-12-08 22:00:22">2025-12-08</time></div></div></div></div></div></div></main><footer id="footer" style="background: transparent;"><div class="footer-other"><div class="footer-copyright"><span class="copyright">&copy;&nbsp;2025 By Yiiong</span><span class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 8.1.1</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.5.2</a></span></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=5.5.2"></script><script src="/js/main.js?v=5.5.2"></script><script src="/"></script><div class="js-pjax"></div><canvas id="universe"></canvas><script src="/js/universe.js"></script><script id="canvas_nest" defer="defer" color="0,0,255" opacity="0.7" zIndex="-1" count="99" mobile="false" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.6/dist/canvas-nest.min.js"></script><script async data-pjax src="/"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><i class="fas fa-spinner fa-pulse" id="loading-status" hidden="hidden"></i><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据加载中</span></div><div class="local-search-input"><input placeholder="搜索文章" type="text"/></div><hr/><div id="local-search-results"></div><div class="ais-Pagination" id="local-search-pagination" style="display:none;"><ul class="ais-Pagination-list"></ul></div><div id="local-search-stats"></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=5.5.2"></script></div></div></body></html>